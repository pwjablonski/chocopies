<!-- This is a static file -->
<!-- served from your routes in server.js -->

<!DOCTYPE html>
<html>
  <head>
    <%- include('../partials/head'); %>
    <title>Eat Chocopie Together - About</title>
    <script>
      (async function(d){
        let pieData = await fetchPies();
        let sent = pieData.sent;
        let eaten = pieData.eaten;
        let total = pieData.total;
        let pies = pieData.pies;
        const piesTable = d.querySelector(".pies__list")
        
        pies.forEach(function(pie){
          const pieId = d.createElement("td")
          const pieSentAt = d.createElement("td")
          const pieEatenAt = d.createElement("td")

          pieId.innerHTML = pie.id
          pieSentAt.innerHTML = pie.sentAt
          pieEatenAt.innerHTML = pie.eatenAt

          
          const pieRow = d.createElement("tr")
          pieRow.append(pieId)
          piesTable.append(pieRow)
        })
        
        async function fetchPies() {
          const req = await fetch("/pies");
          const resp = await req.json();
          return resp;
        }
        
      })(document)
    </script>
  </head>
  <body>
    <header>
      <%- include('../partials/header'); %>
    </header>
    <section class="section">
      <table class="pies__list table">
        <thead>
          <th>Id</th>
          <th>Sent At</th>
          <th>Eaten At</th>
        </thead>
        
      </table>
    </section>
    <footer class="footer">
      <%- include('../partials/footer'); %>
    </footer>
  </body>
</html>
